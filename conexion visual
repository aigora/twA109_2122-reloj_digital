Serial* Arduino;
char puerto[] = "COM5"; // Puerto serie en el que está conectado Arduino
char BufferEntrada[200];
int bytesRecibidos;

Arduino = new Serial((char*)puerto); // Crea conexión lógica con Arduino
if (Arduino->IsConnected())
printf("Arduino conectado\n");
else
printf("Error\n");
while (Arduino->IsConnected())
{

	bytesRecibidos = Arduino->ReadData(BufferEntrada, sizeof(char) * 199);
	if (bytesRecibidos != -1) // Lectura de mensaje desde el puerto
	{
		BufferEntrada[bytesRecibidos - 1] = '\0';
		printf(" %s\n", BufferEntrada);
	}
	else
		Sleep(1000);
}
